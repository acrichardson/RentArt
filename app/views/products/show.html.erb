<%= render 'shared/navbar' %>

<div class="container mt-3">

  <div class="card-product">
   <%= cl_image_tag @product.photo.attached? ? @product.photo.key : "pn4d9wzxnc9advmnrniw", width: 400, height: 300, crop: :fill %>
   <div class="card-product-infos">
    <h1><%= @product.name %> <% if policy(@product).destroy? %><%= link_to product_path(@product), method: :delete, data: {confirm: "Are you sure you want to delete this product?"} do%>
    <i class="fas fa-trash-alt"></i>
    <% end %>
    <% end %>
  </h1>
     <ul class="productList">
      <li><%= @product.details %></li>
      <li><%= "- € #{@product.price} per day" %></li>
      <li><%= "- Category: #{@product.category}" %></li>
    </ul>
  </div>
</div>

<a class="btn btn-primary" data-toggle="collapse" href="#collapseExample" role="button" aria-expanded="false" aria-controls="collapseExample">
  Show <%= @product.name %> reservations
</a>
<div class="collapse" id="collapseExample">
  <div class="card card-body">
    <ol>
      <% @product.reservations.each do |reservation| %>
       <ul class="productList mt-2">
          <li><strong><%= "Booked from: #{reservation.start_date} Until: #{reservation.end_date}"%></strong></li>
          <li><%= "Total price: € #{reservation.price}" %></li>
        </ul>
      <% end %>
    </ol>


  </div>
</div>

<div class="mt-5">

  <p><% if policy(Reservation).create? %><%= link_to "Book now!", new_product_reservation_path(@product) %>
   <% end %>
 </p>
 <p><%= link_to "Back to products", products_path %></p>

 <p><% if policy(@product).edit? %>
  <%= link_to "Update #{@product.name}", edit_product_path(@product) %>
  <% end %></p>
</div>
</div>
